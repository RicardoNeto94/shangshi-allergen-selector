
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shang Shi — Menu (Cards)</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <div class="header sticky compact">
    <div class="inner">
      <div class="brand">Shang Shi <span class="badge">Card Layout</span></div>
      <nav class="nav"><a class="btn" href="ingredients.html">All Ingredients</a></nav>
    </div>
  </div>

  <div class="container">
    <h1>Menu</h1>
    <p class="small">Swipeable, scannable cards. Tap “Learn More” for full ingredients and allergens.</p>

    <div id="cards" class="grid"></div>
  </div>

  <div class="footer">
    <div class="container small">© Shang Shi • Elevated & modern</div>
  </div>

  <script src="assets/script.js"></script>
  <script>
  
async function loadJSON(path) {
  const res = await fetch(path);
  if (!res.ok) throw new Error("Failed to load " + path);
  return res.json();
}

function param(name) {
  const params = new URLSearchParams(window.location.search);
  return params.get(name);
}

function createAllergenChips(codes, map) {
  const wrap = document.createElement('div');
  wrap.className = 'allergen-wrap';
  codes.forEach(c => {
    const chip = document.createElement('span');
    chip.className = 'chip';
    chip.textContent = c;
    chip.title = map[c] || c;
    wrap.appendChild(chip);
  });
  return wrap;
}

  async function renderCards() {
    const data = await loadJSON('data/dishes.json');
    const root = document.getElementById('cards');
    data.dishes.forEach(d => {
      const card = document.createElement('article');
      card.className = 'card';
      card.innerHTML = `
        <div class="card-body">
          <h3 class="dish-name">{}</h3>
          <p class="desc">{}</p>
          <div class="meta">
            <span class="price">{}</span>
            <a class="btn" href="ingredients.html?dish=${d.id}">Learn More</a>
          </div>
        </div>
      `.replace('{}', d.name).replace('{}', d.short).replace('{}', d.price);
      card.appendChild(createAllergenChips(d.allergens, data.allergens));
      root.appendChild(card);
    });
  }
  renderCards();
  </script>
</body>
</html>
